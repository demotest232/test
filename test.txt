JoranConfigurator configurator = new JoranConfigurator() {
        @Override
        protected SAXParserFactory buildSAXParserFactory() {
            SAXParserFactory spf = super.buildSAXParserFactory();
            try {
                // Secure the parser
                spf.setFeature("http://xml.org/sax/features/external-general-entities", false);
                spf.setFeature("http://xml.org/sax/features/external-parameter-entities", false);
                spf.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
                spf.setFeature(javax.xml.XMLConstants.FEATURE_SECURE_PROCESSING, true);
            } catch (Exception e) {
                addError("Failed to configure secure SAX parser", e);
            }
            return spf;
        }
    };
